//
// ux.js v0.2.1
//
// https://github.com/lyngbach/ux.js
//
// Copyright 2015, Rune Lyngbach Jensen
// Email: lyngbachjensen@gmail.com
//
// licensed under MIT

var ux=function(t){"use strict";var e;this.options=t||{},this.options.widthMargin=this.options.widthMargin||70,this.options.topMargin=this.options.topMargin||27,this.onBrowserResize=function(){var t=this;clearTimeout(e),e=setTimeout(function(){t.reAdjust()},150)},window.onresize=this.onBrowserResize.bind(this)};ux.prototype.show=function(){"use strict";var t,e,o=document.querySelectorAll("[data-ux-text]");for(e=0;e<o.length;e+=1)this.addTooltip(o[e]);t=document.createElement("div"),t.className="ux_overlay",t.id="ux_overlay",t.onclick=this.hide,document.body.appendChild(t),setTimeout(function(){t.className+=" fade"},50)},ux.prototype.hide=function(){"use strict";var t,e=document.querySelectorAll(".ux_tooltip"),o=document.getElementById("ux_overlay");for(t=0;t<e.length;t+=1)e[t].parentNode.removeChild(e[t]);o.className="ux_overlay",setTimeout(function(){o.parentNode.removeChild(o)},300)},ux.prototype.visible=function(){"use strict";var t=document.getElementById("ux_overlay");return t},ux.prototype.addTooltip=function(t){"use strict";var e=document.createElement("div");e.innerHTML=t.getAttribute("data-ux-text"),null===t.getAttribute("data-ux-original")&&t.setAttribute("data-ux-original",t.getAttribute("data-ux-position")),e.className="ux_tooltip",document.body.appendChild(e),this.positionTooltip(t,e)},ux.prototype.positionTooltip=function(t,e){"use strict";switch(e%1===0&&(e=document.querySelectorAll(".ux_tooltip")[e]),this.getPosition(t)){case"top":this.responsive(t,e);break;case"topLeft":this.responsive(t,e);break;case"topRight":this.responsive(t,e);break;case"right":this.responsive(t,e);break;case"bottom":this.responsive(t,e);break;case"bottomRight":this.responsive(t,e);break;case"bottomLeft":this.responsive(t,e);break;case"left":this.responsive(t,e)}},ux.prototype.getPosition=function(t){"use strict";return t.getAttribute("data-ux-position")||"bottom"},ux.prototype.setPosition=function(t,e,o){"use strict";switch(t.getAttribute("data-ux-position")){case"top":e.className="ux_tooltip ux_top",e.style.left=o.x+t.offsetWidth/2-e.offsetWidth/2+"px",e.style.top=o.y-e.offsetHeight-this.options.widthMargin+"px";break;case"topLeft":e.className="ux_tooltip ux_top_left",e.style.left=o.x-e.offsetWidth+t.offsetWidth/2-this.options.widthMargin+"px",e.style.top=o.y-e.offsetHeight-this.options.topMargin+"px";break;case"topRight":e.className="ux_tooltip ux_top_right",e.style.left=o.x+t.offsetWidth/2+this.options.widthMargin+"px",e.style.top=o.y-e.offsetHeight-this.options.topMargin+"px";break;case"right":e.className="ux_tooltip ux_right",e.style.left=o.x+t.offsetWidth+this.options.widthMargin+"px",e.style.top=o.y+(t.offsetHeight-e.offsetHeight)/2+"px";break;case"bottom":e.className="ux_tooltip ux_bottom",e.style.left=o.x+t.offsetWidth/2-e.offsetWidth/2+"px",e.style.top=o.y+t.offsetHeight+this.options.widthMargin+"px";break;case"bottomRight":e.className="ux_tooltip ux_bottom_right",e.style.left=o.x+t.offsetWidth/2+this.options.widthMargin+"px",e.style.top=o.y+t.offsetHeight+this.options.topMargin+"px";break;case"bottomLeft":e.className="ux_tooltip ux_bottom_left",e.style.left=o.x-e.offsetWidth+t.offsetWidth/2-this.options.widthMargin+"px",e.style.top=o.y+t.offsetHeight+this.options.topMargin+"px";break;case"left":e.className="ux_tooltip ux_left",e.style.left=o.x-e.offsetWidth-this.options.widthMargin+"px",e.style.top=o.y+(t.offsetHeight-e.offsetHeight)/2+"px"}},ux.prototype.getCoordinates=function(t,e){"use strict";for(var o=0,i=0,s=t;s;)o+=s.offsetLeft-s.scrollLeft+s.clientLeft,i+=s.offsetTop-s.scrollTop+s.clientTop,s=s.offsetParent;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(i+=window.pageYOffset),this.setPosition(t,e,{x:o,y:i})},ux.prototype.getOffset=function(t){"use strict";for(var e=0,o=0,i=t;i;)e+=i.offsetLeft-i.scrollLeft+i.clientLeft,o+=i.offsetTop-i.scrollTop+i.clientTop,i=i.offsetParent;return{x:e,y:o}},ux.prototype.responsive=function(t,e){"use strict";var o=this;switch(t.getAttribute("data-ux-position")){case"top":this.getCoordinates(t,e);break;case"topLeft":this.getCoordinates(t,e);break;case"topRight":this.getCoordinates(t,e);break;case"right":this.getCoordinates(t,e);break;case"bottom":this.getCoordinates(t,e);break;case"bottomRight":this.getCoordinates(t,e);break;case"bottomLeft":this.getCoordinates(t,e);break;case"left":this.getCoordinates(t,e)}setTimeout(function(){if(o.options.responsive)switch(t.getAttribute("data-ux-original")){case"left":case"topLeft":case"bottomLeft":if(o.getOffset(t).x<e.offsetWidth+o.options.widthMargin){for(var i=t,s=0;i;)s+=i.offsetLeft-i.scrollLeft+i.clientLeft,i=i.offsetParent;t.offsetWidth/2+s<100+o.options.widthMargin?window.innerWidth-(t.offsetWidth/2+s)<110+o.options.widthMargin?"bottomLeft"===t.getAttribute("data-ux-original")?t.setAttribute("data-ux-position","bottom"):t.setAttribute("data-ux-position","top"):"bottomLeft"===t.getAttribute("data-ux-original")?t.setAttribute("data-ux-position","bottomRight"):t.setAttribute("data-ux-position","topRight"):t.offsetWidth/2+s<e.offsetWidth+o.options.widthMargin?"bottomLeft"===t.getAttribute("data-ux-original")?t.setAttribute("data-ux-position","bottom"):t.setAttribute("data-ux-position","top"):"bottomLeft"===t.getAttribute("data-ux-original")?t.setAttribute("data-ux-position","bottomLeft"):t.setAttribute("data-ux-position","topLeft")}else t.setAttribute("data-ux-position",t.getAttribute("data-ux-original"));break;case"right":case"topRight":case"bottomRight":window.innerWidth-(o.getOffset(t).x+t.offsetWidth)<110+o.options.widthMargin?window.innerWidth-(o.getOffset(t).x+t.offsetWidth/2)>110+o.options.widthMargin?"bottomRight"===t.getAttribute("data-ux-original")?t.setAttribute("data-ux-position","bottomRight"):t.setAttribute("data-ux-position","topRight"):t.offsetWidth/2+o.getOffset(t).x<e.offsetWidth+o.options.widthMargin?"bottomRight"===t.getAttribute("data-ux-original")?t.setAttribute("data-ux-position","bottom"):t.setAttribute("data-ux-position","top"):"bottomRight"===t.getAttribute("data-ux-original")?t.setAttribute("data-ux-position","bottomLeft"):t.setAttribute("data-ux-position","topLeft"):t.setAttribute("data-ux-position",t.getAttribute("data-ux-original")),setTimeout(function(){t.offsetWidth/2+o.getOffset(t).x<e.offsetWidth+o.options.widthMargin&&("bottomRight"===t.getAttribute("data-ux-original")?t.setAttribute("data-ux-position","bottom"):t.setAttribute("data-ux-position","top")),o.getCoordinates(t,e)},300)}o.getCoordinates(t,e)},300)},ux.prototype.reAdjust=function(){"use strict";if(null!==this.visible()){var t,e=document.querySelectorAll("[data-ux-text]");for(t=0;t<e.length;t+=1)this.positionTooltip(e[t],t,!0)}};